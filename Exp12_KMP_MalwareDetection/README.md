# Experiment 12 â€” Knuthâ€“Morrisâ€“Pratt (KMP) String Matching Algorithm

**Course:** CS2111 â€“ Advanced Data Structures & Algorithms  
**Lab:** ADSA Laboratory  
**Experiment Title:** Pattern Matching Using KMP Algorithm  
**Language Used:** C  
**Application Example:** Detecting Malware Signature in Cyber Security Log Files  

**Subject Teacher:** Prof. K. S. Gandle  
**Mr. Rehan Mokashi**  
*Student, F.Y. M.Tech (Computer Science & Engineering)*  
**Government College of Engineering, Karad (GCEK)**  

---

## **Aim**

To implement the **Knuthâ€“Morrisâ€“Pratt (KMP) String Matching Algorithm** using its **LPS (Longest Prefix Suffix) table**, and apply it for efficiently detecting malware signature patterns inside large **cyber security log files**.

---

## **Overview of KMP Algorithm**

The **KMP Algorithm** is an optimized string-matching technique that avoids unnecessary comparisons by using an auxiliary table called **LPS (Longest Prefix Suffix)**.

### âœ” Why KMP is Efficient?

* Time complexity: **O(n + m)**
* Does **not re-compare** characters after mismatch
* Uses prefixâ€“suffix relationships to compute intelligent shifts
* Very effective on **large log files, documents, DNA sequences, and code bases**

### âœ” Real-Time Usage

KMP is widely used in:

* **Cyber security log analysis**
* **Antivirus signature detection**
* **Search engines & text editors**
* **Bioinformatics sequence matching**
* **Large file scanning tools (grep, IDEs)**

---

## ğŸ›¡ï¸ **Application Example â€” Malware Signature Detection in Logs**

Cyber security systems generate large logs containing:

* Login events
* Warning messages
* File scan results
* Malware alerts

A predefined malware signature (byte / string pattern) can be searched inside these logs.

### **Example Malware Signature**

```
X5O!P%@AP[4\PZX
```

*(This resembles standard EICAR test signature.)*

### **Example Log Text**

```
2025-12-06 10:06:12 INFO  Scanning file payload.exe
2025-12-06 10:06:13 ALERT Malware signature X5O!P%@AP[4\PZX found in payload.exe
```

KMP efficiently identifies the malware string within the long log content.

---

## ğŸ§± **LPS (Longest Prefix Suffix) Table**

The **LPS array** stores, for each position in the pattern:

> The length of the longest prefix of the pattern
> which is also a suffix up to that position.

This table avoids repeated comparison when mismatch occurs.

### Example

Pattern: `ABABAC`

| Index | Char | LPS |
| ----- | ---- | --- |
| 0     | A    | 0   |
| 1     | B    | 0   |
| 2     | A    | 1   |
| 3     | B    | 2   |
| 4     | A    | 3   |
| 5     | C    | 0   |

---

## ğŸ“‚ **Project Structure**

```
Exp12_KMP_MalwareDetection/
â”‚â”€â”€ main.c
â”‚â”€â”€ kmp.c
â”‚â”€â”€ kmp.h
â”‚â”€â”€ README.md   â† (this file)
```

---

## **How to Compile**

```bash
gcc main.c kmp.c -o exp12
```

Run program:

```bash
./exp12          # Windows: exp12.exe
```

---

## ğŸ§ª **Demo Input (Option 1 â€” Preloaded Security Log)**

### Text:

```
2025-12-06 10:01:23 INFO  System boot complete
2025-12-06 10:02:10 INFO  User login from 192.168.1.10
2025-12-06 10:05:47 WARN  Suspicious activity detected
2025-12-06 10:06:12 INFO  Scanning file payload.exe
2025-12-06 10:06:13 ALERT Malware signature X5O!P%@AP[4\PZX found in payload.exe
2025-12-06 10:06:15 INFO  File quarantined successfully
```

### Pattern:

```
X5O!P%@AP[4\PZX
```

---

## ğŸ“œ **Sample Output**

```
=== LPS (Longest Prefix Suffix) Table Construction ===
Index   pattern[i]   LPS[i]   len(before)   len(after)
1          5            0          0            0
2          O            0          0            0
...

=== KMP Pattern Matching Trace ===
Text length = 260, Pattern length = 14

Match: pattern[0] = 'X' with text[145] = 'X'
Match: pattern[1] = '5' with text[146] = '5'
Match: pattern[2] = 'O' with text[147] = 'O'
...
Match: pattern[13] = 'X' with text[158] = 'X'
âœ” Match found at text index 145

Total matches found: 1
```

*(Indices vary slightly based on formatting.)*

---

## **Algorithm Summary**

### ğŸ”¹ *LPS Table Construction*

1. Initialize `lps[0] = 0`
2. Compare pattern characters to build prefixâ€“suffix relationships
3. Use previous LPS values to avoid recomputation

### ğŸ”¹ *Pattern Matching*

1. Compare text & pattern character by character
2. On mismatch:

   * If `j != 0` â†’ use `j = lps[j âˆ’ 1]`
   * Otherwise â†’ move to next text character
3. On full match:

   * Report index
   * Continue searching using LPS

### ğŸ”¹ *Complexity Analysis*

| Phase            | Complexity   |
| ---------------- | ------------ |
| LPS Construction | O(m)         |
| Pattern Matching | O(n)         |
| **Total**        | **O(n + m)** |

---

## **Conclusion**

This experiment demonstrates:

âœ” Efficient implementation of **KMP Algorithm**  
âœ” Construction and use of the **LPS table**  
âœ” Faster string search compared to brute-force  
âœ” Practical cyber security application â€” **detecting malware signatures in logs**  
âœ” How prefixâ€“suffix patterns can optimize pattern matching  

KMP remains one of the most widely used and foundational algorithms in **pattern searching and cyber security**.

---

## **Author**

**Mr. Rehan Mokashi**
*Student, F.Y. M.Tech (Computer Science & Engineering)*  
**Government College of Engineering, Karad (GCEK)**

**Subject:** Advanced Data Structures and Algorithms (ADSA)  
**Subject Teacher:** Prof. K. S. Gandle

**Experiment:** ADSA Laboratory â€” Experiment 12 (KMP Algorithm)